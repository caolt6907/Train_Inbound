机器人智能营销项目开发我主要负责拨打模块、通话模块、tts转换模块、读取配置模块和发送消息机制等几部分功能开发。
由于整个项目要进行多项目同时进行、并且多个机器人同时拨打。系统采用把项目配置文件和拨打的话术控制流程及拨打的手机号都放在redis上，
由于读取项目配置、读取话术流程等都在不同的模块里进行，所以采用了redis连接池让需要的模块通过获取连接池(原来用过单一静态模式运行一段时间后会报各种错误)的对象来进行redis操作。
由于要把各种消息反馈给后台服务器以便于统计分析，所以要建立kafka连接对象。
TTS转换在项目中有几个地方需要使用，所以要生成TTS连接对象。
主线程：
主线程开始要先获取redis连接池对象、启动TTS转换定时线程先暂定的是1分钟执行一次。
主线程接着要启动呼入等待线程(异步)。
主线程通过获取redis对象来读取项目配置，把在工作时间范围内但有没有进行工作的项目启动起来，主要是对该项目建一个拨打号码队列、根据机器人数建立相同数量的拨打线程，保存拨打线程对象和号码队列对象。
、读取该项目的手机号码配置添加到该项目的拨打队列。每个6秒检测一下如还在工作时间范围内通过redis往项目的拨打队列条件手机号，如redis上手机号为空通过kafka通知后台服务器添加。
如该项目不在工作时间范围内，设置拨打线程结束标志、删除拨打线程对象、把在拨打队列里的没有打完的号码返回给redis、删除队列对象。

TTS定时转换线程：
线程执行流程是读取redis上的需转换的内容，进行tts转换。成功后把内容清空。

拨打线程：
线程执行流程是循环读取号码队列里的手机号，成功后调用fsjar包里的方法进行拨打接收到返回标志后，取下一个号码，这里的拨打线程可能是多个线程同时读取队列，BlockingQueue带并发处理。

呼入线程：
线程执行流程是等待fs呼入，执行应答同时接收到拨打线程传入的参数调用redis读取相关话术表匹配到“开始”，通过fs提供的函数进行语音播放返回用户的语音文本通过正则表达式匹配话术匹配表的
文本如有多个通过优先级排序找出最高级所指向的话术表项，按照返回的类型“内容”、“全局”、“跳转”走各自流程，根据用户返回的语音文本再次通过话术匹配表文本进行匹配这样循环。碰到结束标志后或者三次无法识别用户文本退出循环
播放结束语音。这里有个需指出的是碰到播放语音文件要是找不到通过tts进行现时转换进行播放。


